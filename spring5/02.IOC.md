# IOC

### IOCï¼ˆæ¦‚å¿µå’ŒåŸç†ï¼‰

1. ä»€ä¹ˆæ˜¯IOC
    - æ§åˆ¶åè½¬ï¼ŒæŠŠå¯¹è±¡åˆ›å»ºå’Œå¯¹è±¡ä¹‹é—´çš„è°ƒç”¨è¿‡ç¨‹ï¼Œäº¤ç»™Springè¿›è¡Œç®¡ç†
2. ä½¿ç”¨IOCç›®çš„
    - è€¦åˆåº¦é™ä½
3. IOCåº•å±‚åŸç†
    - xmlè§£æã€å·¥å‚æ¨¡å¼ã€åå°„

### IOCï¼ˆBeanFactoryæ¥å£ï¼‰

1. IOCæ€æƒ³åŸºäºIOCå®¹å™¨å®Œæˆï¼ŒIOCå®¹å™¨åº•å±‚å°±æ˜¯å¯¹è±¡å·¥å‚
2. Springæä¾›IOCå®¹å™¨å®ç°ä¸¤ç§æ–¹å¼ï¼ˆä¸¤ä¸ªæ¥å£ï¼‰
    1. BeanFactoryï¼šIOCå®¹å™¨åŸºæœ¬å®ç°ï¼Œæ˜¯Springå†…éƒ¨çš„ä½¿ç”¨æ¥å£ï¼Œä¸æä¾›å¼€å‘äººå‘˜è¿›è¡Œä½¿ç”¨ï¼ŒåŠ è½½é…ç½®æ–‡ä»¶æ—¶å€™ä¸ä¼šåˆ›å»ºå¯¹è±¡ï¼Œåœ¨è·å–å¯¹è±¡ï¼ˆä½¿ç”¨ï¼‰æ‰å»åˆ›å»ºå¯¹è±¡
    2. ApplicationContextï¼šBeanFactoryæ¥å£çš„å­æ¥å£ï¼Œæä¾›æ›´å¤šæ›´å¼ºå¤§çš„åŠŸèƒ½ï¼Œä¸€èˆ¬ç”±å¼€å‘äººå‘˜è¿›è¡Œä½¿ç”¨ï¼ŒåŠ è½½é…ç½®æ–‡ä»¶æ—¶å€™å°±ä¼šæŠŠåœ¨é…ç½®æ–‡ä»¶å¯¹è±¡è¿›è¡Œåˆ›å»º
    3. ApplicationContextæ¥å£çš„å®ç°ç±»
        - FileSystemXmlApplicationContext
        - ClassPathXmlApplicationContext
        
        <aside>
        ğŸ’¡ FileSystemXmlApplicationContexté€šè¿‡ç›˜ç¬¦è·¯å¾„åŠ è½½Xmlé…ç½®æ–‡ä»¶
        
        </aside>
        

### IOCæ“ä½œBeanç®¡ç†ï¼ˆæ¦‚å¿µï¼‰

1. ä»€ä¹ˆæ˜¯Beanç®¡ç†
    - Beanç®¡ç†æŒ‡çš„æ˜¯ä¸¤ä¸ªæ“ä½œ
        - Springåˆ›å»ºå¯¹è±¡
        - Spirngæ³¨å…¥å±æ€§
2. Beanç®¡ç†æ“ä½œæœ‰ä¸¤ç§æ–¹å¼
    - åŸºäºxmlé…ç½®æ–‡ä»¶æ–¹å¼å®ç°
    - åŸºäºæ³¨è§£æ–¹å¼å®ç°

### IOCæ“ä½œBeanç®¡ç†â€”â€”åŸºäºXmlæ–¹å¼

1. åŸºäºxmlæ–¹å¼åˆ›å»ºå¯¹è±¡
    1. åœ¨springé…ç½®æ–‡ä»¶ä¸­ï¼Œä½¿ç”¨beanæ ‡ç­¾ï¼Œæ ‡ç­¾é‡Œé¢æ·»åŠ å¯¹åº”å±æ€§ï¼Œå°±å¯ä»¥å®ç°å¯¹è±¡åˆ›å»º
        
        ```java
        <!--é…ç½®Userå¯¹è±¡åˆ›å»º--> 
        <bean id="user" class="com.tyd.spring5.User"></bean>
        ```
        
    2. åˆ›å»ºå¯¹è±¡æ—¶å€™ï¼Œé»˜è®¤ä¹Ÿæ˜¯æ‰§è¡Œæ— å‚æ•°æ„é€ æ–¹æ³•å®Œæˆå¯¹è±¡åˆ›å»º
2. åŸºäºxmlæ–¹å¼æ³¨å…¥å±æ€§ï¼ˆåŸºæœ¬å±æ€§ï¼‰
    
    <aside>
    ğŸ’¡ DIï¼šä¾èµ–æ³¨å…¥ï¼Œå°±æ˜¯æ³¨å…¥å±æ€§
    
    </aside>
    
    - ç¬¬ä¸€ç§æ³¨å…¥æ–¹å¼ï¼šä½¿ç”¨setæ–¹æ³•è¿›è¡Œæ³¨å…¥
        - åˆ›å»ºç±»ï¼Œå®šä¹‰å±æ€§å’Œå¯¹åº”çš„setæ–¹æ³•
            
            ```java
            public class Book {
                //åˆ›å»ºå±æ€§
                private String bname;
                private String bauthor;
                //åˆ›å»ºå±æ€§å¯¹åº”çš„setæ–¹æ³•
                public void setBname(String bname) {
                    this.bname = bname;
                }
                public void setBauthor(String bauthor) {
                    this.bauthor = bauthor;
                }
            }
            ```
            
        - åœ¨springé…ç½®æ–‡ä»¶é…ç½®å¯¹è±¡åˆ›å»ºï¼Œé…ç½®å±æ€§æ³¨å…¥
            
            ```xml
            <bean id="book" class="com.tyd.spring5.Book">
                    <!--ä½¿ç”¨propertyå®Œæˆå±æ€§æ³¨å…¥
                        nameï¼šç±»é‡Œé¢å±æ€§åç§°
                        valueï¼šå‘å±æ€§æ³¨å…¥çš„å€¼
                    -->
                    <property name="bname" value="è¥¿æ¸¸è®°"></property>
                    <property name="bauthor" value="å´æ‰¿æ©"></property>
                </bean>
            ```
            
    - ç¬¬äºŒç§æ³¨å…¥æ–¹å¼ï¼šä½¿ç”¨æœ‰å‚æ•°æ„é€ è¿›è¡Œæ³¨å…¥
        - åˆ›å»ºç±»ï¼Œå®šä¹‰å±æ€§ï¼Œåˆ›å»ºå±æ€§å¯¹åº”æœ‰å‚æ•°æ„é€ æ–¹æ³•
            
            ```java
            public class Orders {
                //å±æ€§
                private String oname;
                private String address;
                //æœ‰å‚æ•°æ„é€ 
                public Orders(String oname, String address) {
                    this.oname = oname;
                    this.address = address;
                }
            }
            ```
            
        - åœ¨springé…ç½®æ–‡ä»¶ä¸­è¿›è¡Œé…ç½®
            
            ```xml
            <!--3 æœ‰å‚æ•°æ„é€ æ³¨å…¥å±æ€§-->
                <bean id="orders" class="com.tyd.spring5.Orders">
                    <constructor-arg name="oname" value="ç”µè„‘"></constructor-arg>
                    <constructor-arg name="address" value="China"></constructor-arg>
                </bean>
            ```
            
    - påç§°ç©ºé—´æ³¨å…¥ï¼ˆç®€åŒ–Setæ³¨å…¥æ–¹æ³•ï¼‰
        - æ·»åŠ påç§°ç©ºé—´åœ¨é…ç½®æ–‡ä»¶ä¸­
            
            ```xml
            <beans xmlns="http://www.springframework.org/schema/beans"
                   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xmlns:p="http://www.springframework.org/schema/p">
            ```
            
        - è¿›è¡Œå±æ€§æ³¨å…¥ï¼Œåœ¨beanæ ‡ç­¾é‡Œé¢è¿›è¡Œæ“ä½œ
            
            ```xml
            <!--2 setæ–¹æ³•æ³¨å…¥å±æ€§--> 
            <bean id="book" class="com.atguigu.spring5.Book" p:bname="ä¹é˜³ç¥åŠŸ" p:bauthor="æ— åæ°"></bean>
            ```
            
3. åŸºäºXml æ³¨å…¥å±æ€§ï¼ˆå…¶ä»–ç±»å‹ï¼‰
    - å­—é¢é‡
        - nullå€¼
            
            ```xml
            <!--nullå€¼ï¼Œåˆå§‹åŒ–addressçš„å€¼ä¸ºnull--> 
            <property name="address"> <null/> </property>
            ```
            
        - å±æ€§å€¼åŒ…å«ç‰¹æ®Šç¬¦å·
            
            ```xml
            <!--å±æ€§å€¼åŒ…å«ç‰¹æ®Šç¬¦å· 
            	1 æŠŠ<>è¿›è¡Œè½¬ä¹‰ &lt; &gt; 
            	2 æŠŠå¸¦ç‰¹æ®Šç¬¦å·å†…å®¹å†™åˆ°CDATA 
            --> 
            <property name="address"> 
            	<value><![CDATA[<<å—äº¬>>]]></value> 
            </property>
            <!--addressçš„å€¼ä¸º<<å—äº¬>>-->
            ```
            
    - å¤–éƒ¨bean
        - å®šä¹‰ä¸€ä¸ªDaoæ¥å£å®ç°ç±»
            
            ```java
            public class UserDaoImpl implements UserDao {
                @Override
                public void update() {
                    System.out.println("å¤–éƒ¨bean");
                }
            }
            ```
            
        - å®šä¹‰ä¸€ä¸ªServiceç±»
            
            ```java
            public class UserService {
                private UserDao userDao;
            
                public void setUserDao(UserDao userDao) {
                    this.userDao = userDao;
                }
            }
            ```
            
        - é…ç½®Springçš„Xmlæ–‡ä»¶
            
            ```xml
            <bean id="userService" class="com.atguigu.spring5.service.UserService"> 
            <!--æ³¨å…¥userDaoå¯¹è±¡ 
            	nameå±æ€§ï¼šç±»é‡Œé¢å±æ€§åç§° 
            	refå±æ€§ï¼šåˆ›å»ºuserDaoå¯¹è±¡beanæ ‡ç­¾idå€¼ 
            --> 
            	<property name="userDao" ref="userDaoImpl"></property> 
            </bean> 
            
            <bean id="userDaoImpl" class="com.atguigu.spring5.dao.UserDaoImpl"></bean>
            ```
            
    - å†…éƒ¨bean
        - åœ¨å®ä½“ç±»ä¹‹é—´è¡¨ç¤ºä¸€å¯¹å¤šå…³ç³»ï¼ˆä¸€ä¸ªéƒ¨é—¨æœ‰å¤šä¸ªå‘˜å·¥ï¼Œä¸€ä¸ªå‘˜å·¥å±äºä¸€ä¸ªéƒ¨é—¨ï¼‰
        - åˆ›å»ºéƒ¨é—¨ç±»å’Œå‘˜å·¥ç±»
            
            ```java
            //éƒ¨é—¨ç±» 
            public class Dept { 
            	private String dname; 
            	public void setDname(String dname) { 
            		this.dname = dname; 
            	} 
            } 
            //å‘˜å·¥ç±» 
            public class Emp { 
            	private String ename; 
            	private String gender; 
            	//å‘˜å·¥å±äºæŸä¸€ä¸ªéƒ¨é—¨ï¼Œä½¿ç”¨å¯¹è±¡å½¢å¼è¡¨ç¤º 
            	private Dept dept; 
            	public void setDept(Dept dept) { 
            		this.dept = dept; 
            	} 
            	public void setEname(String ename) { 
            		this.ename = ename; 
            	} 
            	public void setGender(String gender) { 
            		this.gender = gender;
            	}
            }
            ```
            
        - é…ç½®Xmlæ–‡ä»¶
            
            ```xml
            <!--å†…éƒ¨bean--> 
            <bean id="emp" class="com.atguigu.spring5.bean.Emp"> 
            	<!--è®¾ç½®ä¸¤ä¸ªæ™®é€šå±æ€§--> 
            	<property name="ename" value="lucy"></property> 
            	<property name="gender" value="å¥³"></property> 
            	<!--è®¾ç½®å¯¹è±¡ç±»å‹å±æ€§--> 
            	<property name="dept"> 
            		<bean id="dept" class="com.atguigu.spring5.bean.Dept"> 
            			<property name="dname" value="å®‰ä¿éƒ¨"></property> 
            		</bean> 
            	</property> 
            </bean>
            ```
            
4. åŸºäºXmlæ³¨å…¥å±æ€§ï¼ˆé›†åˆå±æ€§ï¼‰
    - æ³¨å…¥æ•°ç»„ã€Listã€Mapã€Setç­‰é›†åˆå±æ€§
        - åˆ›å»ºç±»ï¼Œå®šä¹‰æ•°ç»„ã€listã€mapã€setç±»å‹å±æ€§ï¼Œç”Ÿæˆå¯¹åº”setæ–¹æ³•
            
            ```java
            public class Stu {
                //1 æ•°ç»„ç±»å‹å±æ€§
                private String[] courses;
                //2 listé›†åˆç±»å‹å±æ€§
                private List<String> list;
                //3 mapé›†åˆç±»å‹å±æ€§
                private Map<String,String> maps;
                //4 seté›†åˆç±»å‹å±æ€§
                private Set<String> sets;
                
                public void setSets(Set<String> sets) {
                    this.sets = sets;
                }
                public void setCourses(String[] courses) {
                    this.courses = courses;
                }
                public void setList(List<String> list) {
                    this.list = list;
                }
                public void setMaps(Map<String, String> maps) {
                    this.maps = maps;
                }
            ```
            
        - åœ¨springé…ç½®æ–‡ä»¶è¿›è¡Œé…ç½®
            
            ```xml
            <!--ï¼ˆ2ï¼‰åœ¨ spring é…ç½®æ–‡ä»¶è¿›è¡Œé…ç½®-->
                <bean id="stu" class="com.atguigu.spring5.collectiontype.Stu">
                    <!--æ•°ç»„ç±»å‹å±æ€§æ³¨å…¥-->
                    <property name="courses">
                        <array>
                            <value>javaè¯¾ç¨‹</value>
                            <value>æ•°æ®åº“è¯¾ç¨‹</value>
                        </array>
                    </property>
                    <!--listç±»å‹å±æ€§æ³¨å…¥-->
                    <property name="list">
                        <list>
                            <value>å¼ ä¸‰</value>
                            <value>å°ä¸‰</value>
                        </list>
                    </property>
                    <!--mapç±»å‹å±æ€§æ³¨å…¥-->
                    <property name="maps">
                        <map>
                            <entry key="JAVA" value="java"></entry>
                            <entry key="PHP" value="php"></entry>
                        </map>
                    </property>
                    <!--setç±»å‹å±æ€§æ³¨å…¥-->
                    <property name="sets">
                        <set>
                            <value>MySQL</value>
                            <value>Redis</value>
                        </set>
                    </property>
            </bean>
            ```
            
    - åœ¨é›†åˆä¸­è®¾ç½®å¯¹è±¡ç±»å‹å€¼
        - åˆ›å»ºä¸€ä¸ªCourseç±»ï¼Œåœ¨å­¦ç”Ÿç±»Stuä¸­æ·»åŠ å¦‚ä¸‹å±æ€§æˆå‘˜
            
            ```java
            //å­¦ç”Ÿæ‰€å­¦å¤šé—¨è¯¾ç¨‹
                private List<Course> courseList;//åˆ›å»ºé›†åˆ
                public void setCourseList(List<Course> courseList) {
                    this.courseList = courseList;
                }
            ```
            
        - é…ç½®Xmlæ–‡ä»¶
            
            ```xml
            <!--åˆ›å»ºå¤šä¸ªcourseå¯¹è±¡-->
                <bean id="course1" class="com.atguigu.spring5.collectiontype.Course">
                    <property name="cname" value="Spring5æ¡†æ¶"></property>
                </bean>
                <bean id="course2" class="com.atguigu.spring5.collectiontype.Course">
                    <property name="cname" value="MyBatisæ¡†æ¶"></property>
                </bean>
                
               	<!--åœ¨Stuç±»ä¸­æ³¨å…¥listé›†åˆç±»å‹ï¼Œå€¼æ˜¯å¯¹è±¡-->
            		<bean id="stu" class="com.atguigu.spring5.collectiontype.Stu">
                   <property name="courseList">
                       <list>
                           <ref bean="course1"></ref>
                           <ref bean="course2"></ref>
                       </list>
                   </property>
            		</bean>
            ```
            
    - æŠŠé›†åˆæ³¨å…¥éƒ¨åˆ†æå–å‡ºæ¥
        - åœ¨springé…ç½®æ–‡ä»¶ä¸­å¼•å…¥åç§°ç©ºé—´ util
            
            ```xml
            <?xml version="1.0" encoding="UTF-8"?>
            <beans xmlns="http://www.springframework.org/schema/beans"
                   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xmlns:util="http://www.springframework.org/schema/util" <!--æ·»åŠ utilåç§°ç©ºé—´-->
                   xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
                                       http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util.xsd"> 
            ```
            
        - ä½¿ç”¨utilæ ‡ç­¾å®Œæˆlisté›†åˆæ³¨å…¥æå–
            
            ```xml
            <!--æŠŠé›†åˆæ³¨å…¥éƒ¨åˆ†æå–å‡ºæ¥-->
             <!--1 æå–listé›†åˆç±»å‹å±æ€§æ³¨å…¥-->
                <util:list id="bookList">
                    <value>æ˜“ç­‹ç»</value>
                    <value>ä¹é˜´çœŸç»</value>
                    <value>ä¹é˜³ç¥åŠŸ</value>
                </util:list>
            
             <!--2 æå–listé›†åˆç±»å‹å±æ€§æ³¨å…¥ä½¿ç”¨-->
                <bean id="book" class="com.atguigu.spring5.collectiontype.Book" scope="prototype">
                    <property name="list" ref="bookList"></property>
                </bean>
            ```
            
5. FactoryBean
    - Springæœ‰ä¸¤ç§ç±»å‹beanï¼Œä¸€ç§æ™®é€šbeanï¼Œå¦å¤–ä¸€ç§å·¥å‚beanï¼ˆFactoryBeanï¼‰
        - æ™®é€šbeanï¼šåœ¨é…ç½®æ–‡ä»¶ä¸­å®šä¹‰beanæ—¶ä¸ºAç±»å‹ï¼Œåˆ™è¿”å›çš„å¯¹è±¡ä¹Ÿæ˜¯Aç±»å‹
        - å·¥å‚beanï¼šåœ¨é…ç½®æ–‡ä»¶ä¸­å®šä¹‰beanæ—¶ä¸ºAç±»å‹ï¼Œè¿”å›çš„å¯¹è±¡å¯ä»¥æ˜¯å…¶ä»–ç±»å‹
    - FactoryBeanå®ç°è¿”å›å¯¹è±¡ä¸ºå…¶ä»–ç±»å‹
        - åˆ›å»ºç±»ï¼Œè®©è¿™ä¸ªç±»ä½œä¸ºå·¥å‚beanï¼Œå®ç°æ¥å£ FactoryBean
            
            ```java
            public class MyBean implements FactoryBean<Course> {
            
                //å®šä¹‰è¿”å›bean
                @Override
                public Course getObject() throws Exception {
                    Course course = new Course();
                    course.setCname("abc");
                    return course;
                }
            }
            ```
            
        - é…ç½®Xmlæ–‡ä»¶
            
            ```xml
            <bean id="myBean" class="com.atguigu.spring5.factorybean.MyBean">
            </bean>
            ```
            
        - æµ‹è¯•
            
            ```java
            @Test
            public void test3() {
             ApplicationContext context =
             new ClassPathXmlApplicationContext("bean3.xml");
             Course course = context.getBean("myBean", Course.class);//è¿”å›å€¼ç±»å‹å¯ä»¥ä¸æ˜¯å®šä¹‰çš„beanç±»å‹ï¼
             System.out.println(course);
            }
            ```
            
6. Beanä½œç”¨åŸŸ
    - åœ¨Springé‡Œé¢ï¼Œè®¾ç½®åˆ›å»ºbeanå®ä¾‹æ˜¯å•å®ä¾‹è¿˜æ˜¯å¤šå®ä¾‹
    - åœ¨Springé‡Œé¢ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œbeanæ˜¯å•å®ä¾‹å¯¹è±¡
    - è®¾ç½®beanä¸ºå¤šå®ä¾‹å¯¹è±¡
        - åœ¨springé…ç½®æ–‡ä»¶beanæ ‡ç­¾é‡Œé¢æœ‰å±æ€§ï¼ˆscopeï¼‰ç”¨äºè®¾ç½®å•å®ä¾‹è¿˜æ˜¯å¤šå®ä¾‹
        - scopeå±æ€§å€¼
            - é»˜è®¤å€¼ï¼Œsingletonï¼Œè¡¨ç¤ºæ˜¯å•å®ä¾‹å¯¹è±¡
            - prototypeï¼Œè¡¨ç¤ºæ˜¯å¤šå®ä¾‹å¯¹è±¡
                
                ```xml
                <bean id="book" class="com.atguigu.spring5.collectiontype.Book" scope="prototype"><!--è®¾ç½®ä¸ºå¤šå®ä¾‹-->
                        <property name="list" ref="bookList"></property>
                </bean>
                ```
                
                æµ‹è¯•
                
                ```java
                Book book1=context.getBean("book",Book.class);
                Book book2=context.getBean("book",Book.class);
                System.out.println(book1);
                System.out.println(book2);
                //è¾“å‡ºçš„ä¸¤ä¸ªå¯¹è±¡æŒ‡é’ˆä¸ä¸€æ ·ï¼Œè¯´æ˜æŒ‡å‘ä¸¤ä¸ªä¸åŒå¯¹è±¡
                ```
                
            
            <aside>
            ğŸ’¡ singletonå’ŒprototypeåŒºåˆ«ï¼šé™¤äº†singletonåˆ›å»ºå•å®ä¾‹ï¼Œprototypeåˆ›å»ºå¤šå®ä¾‹ï¼Œå¦å¤–ï¼Œè®¾ç½®scopeå€¼æ˜¯singletonæ—¶å€™ï¼ŒåŠ è½½springé…ç½®æ–‡ä»¶æ—¶å€™å°±ä¼šåˆ›å»ºå•å®ä¾‹å¯¹è±¡ï¼›è®¾ç½®scopeå€¼æ˜¯prototypeæ—¶å€™ï¼Œä¸æ˜¯åœ¨åŠ è½½springé…ç½®æ–‡ä»¶æ—¶å€™åˆ›å»º å¯¹è±¡ï¼Œåœ¨è°ƒç”¨getBeanæ–¹æ³•æ—¶å€™åˆ›å»ºå¤šå®ä¾‹å¯¹è±¡
            
            </aside>
            
7. beanç”Ÿå‘½å‘¨æœŸ
    - æ­£å¸¸ç”Ÿå‘½å‘¨æœŸä¸ºäº”æ­¥ï¼Œè€Œé…ç½®åç½®å¤„ç†å™¨åä¸ºä¸ƒæ­¥
        - é€šè¿‡æ„é€ å™¨åˆ›å»º bean å®ä¾‹ï¼ˆæ— å‚æ•°æ„é€ ï¼‰
        - ä¸º bean çš„å±æ€§è®¾ç½®å€¼å’Œå¯¹å…¶ä»– bean å¼•ç”¨ï¼ˆè°ƒç”¨ set æ–¹æ³•ï¼‰
        - æŠŠ bean å®ä¾‹ä¼ é€’ bean åç½®å¤„ç†å™¨çš„æ–¹æ³• postProcessBeforeInitialization
        - è°ƒç”¨ bean çš„åˆå§‹åŒ–çš„æ–¹æ³•ï¼ˆéœ€è¦è¿›è¡Œé…ç½®åˆå§‹åŒ–çš„æ–¹æ³•ï¼‰
        - æŠŠ bean å®ä¾‹ä¼ é€’ bean åç½®å¤„ç†å™¨çš„æ–¹æ³• postProcessAfterInitialization
        - bean å¯ä»¥ä½¿ç”¨äº†ï¼ˆå¯¹è±¡è·å–åˆ°äº†ï¼‰
        - å½“å®¹å™¨å…³é—­æ—¶å€™ï¼Œè°ƒç”¨ bean çš„é”€æ¯çš„æ–¹æ³•ï¼ˆéœ€è¦è¿›è¡Œé…ç½®é”€æ¯çš„æ–¹æ³•ï¼‰
    - ä»£ç æ¼”ç¤º
        
        ```xml
        <!--é…ç½®æ–‡ä»¶çš„beanå‚æ•°é…ç½®-->
        <bean id="orders" class="com.atguigu.spring5.bean.Orders" init-method="initMethod" destroy-method="destroyMethod">	<!--é…ç½®åˆå§‹åŒ–æ–¹æ³•å’Œé”€æ¯æ–¹æ³•-->
            <property name="oname" value="æ‰‹æœº"></property><!--è¿™é‡Œå°±æ˜¯é€šè¿‡setæ–¹å¼ï¼ˆæ³¨å…¥å±æ€§ï¼‰èµ‹å€¼-->
        </bean>
        
        <!--é…ç½®åç½®å¤„ç†å™¨-->
        <bean id="myBeanPost" class="com.atguigu.spring5.bean.MyBeanPost"></bean>
        ```
        
        ```java
        public class Orders {
             //æ— å‚æ•°æ„é€ 
             public Orders() {
             System.out.println("ç¬¬ä¸€æ­¥ æ‰§è¡Œæ— å‚æ•°æ„é€ åˆ›å»º bean å®ä¾‹");
             }
             private String oname;
             public void setOname(String oname) {
             this.oname = oname;
             System.out.println("ç¬¬äºŒæ­¥ è°ƒç”¨ set æ–¹æ³•è®¾ç½®å±æ€§å€¼");
             }
             //åˆ›å»ºæ‰§è¡Œçš„åˆå§‹åŒ–çš„æ–¹æ³•
             public void initMethod() {
             System.out.println("ç¬¬ä¸‰æ­¥ æ‰§è¡Œåˆå§‹åŒ–çš„æ–¹æ³•");
             }
             //åˆ›å»ºæ‰§è¡Œçš„é”€æ¯çš„æ–¹æ³•
             public void destroyMethod() {
             System.out.println("ç¬¬äº”æ­¥ æ‰§è¡Œé”€æ¯çš„æ–¹æ³•");
             }
        }
        ```
        
        ```java
        public class MyBeanPost implements BeanPostProcessor {//åˆ›å»ºåç½®å¤„ç†å™¨å®ç°ç±»
            @Override
            public Object postProcessBeforeInitialization(Object bean, String beanName) throws BeansException {
                System.out.println("åœ¨åˆå§‹åŒ–ä¹‹å‰æ‰§è¡Œçš„æ–¹æ³•");
                return bean;
            }
            @Override
            public Object postProcessAfterInitialization(Object bean, String beanName) throws BeansException {
                System.out.println("åœ¨åˆå§‹åŒ–ä¹‹åæ‰§è¡Œçš„æ–¹æ³•");
                return bean;
            }
        }
        ```
        
        ```java
        @Test
         public void testBean3() {
        // ApplicationContext context =
        // new ClassPathXmlApplicationContext("bean4.xml");
         ClassPathXmlApplicationContext context =new ClassPathXmlApplicationContext("bean4.xml");
         Orders orders = context.getBean("orders", Orders.class);
         System.out.println("ç¬¬å››æ­¥ è·å–åˆ›å»º bean å®ä¾‹å¯¹è±¡");
         System.out.println(orders);
         //æ‰‹åŠ¨è®© bean å®ä¾‹é”€æ¯
         context.close();
         }
        ```
        
8. beanè‡ªåŠ¨è£…é…
    - beanæ ‡ç­¾å±æ€§autowireï¼Œé…ç½®è‡ªåŠ¨è£…é…
    - autowireå±æ€§å¸¸ç”¨ä¸¤ä¸ªå€¼ï¼š
        - byNameæ ¹æ®å±æ€§åç§°æ³¨å…¥ ï¼Œæ³¨å…¥å€¼beançš„idå€¼å’Œç±»å±æ€§åç§°ä¸€æ ·
        - byTypeæ ¹æ®å±æ€§ç±»å‹æ³¨å…¥
    - byName
        
        ```xml
        <bean id="emp" class="com.atguigu.spring5.autowire.Emp" autowire="byName">
         <!--<property name="dept" ref="dept"></property>-->
        </bean> 
        <bean id="dept" class="com.atguigu.spring5.autowire.Dept"></bean>
        ```
        
    - byType
        
        ```xml
        <bean id="emp" class="com.atguigu.spring5.autowire.Emp" autowire="byType">
         <!--<property name="dept" ref="dept"></property>-->
        </bean> 
        <bean id="dept" class="com.atguigu.spring5.autowire.Dept"></bean>
        ```
        
9. å¤–éƒ¨å±æ€§æ–‡ä»¶ï¼ˆä»¥é…ç½®jdbcä½œä¸ºæ¡ˆä¾‹ï¼‰
    - ç›´æ¥é…ç½®æ•°æ®åº“ä¿¡æ¯
        - å¼•å…¥å¾·é²ä¼Šè¿æ¥æ± ä¾èµ–jaråŒ…
            
            ![ioc](./images/ioc.png)
            
        - ç›´æ¥é…ç½®è¿æ¥æ± 
            
            ```xml
            <!--ç›´æ¥é…ç½®è¿æ¥æ± -->
                <bean id="dataSource" class="com.alibaba.druid.pool.DruidDataSource">
                    <property name="driverClassName" value="com.mysql.jdbc.Driver"></property>
                    <property name="url" value="jdbc:mysql://localhost:3306/userDb"></property>
                    <property name="username" value="root"></property>
                    <property name="password" value="root"></property>
                </bean>
            ```
            
    - ä½¿ç”¨å¤–éƒ¨å±æ€§æ–‡ä»¶
        - åˆ›å»ºå¤–éƒ¨å±æ€§æ–‡ä»¶ï¼Œproperties æ ¼å¼ï¼Œå†™æ•°æ®åº“ä¿¡æ¯ï¼ˆ**jdbc.properties**ï¼‰
            
            ```xml
            prop.driverClass=com.mysql.jdbc.Driver
            prop.url=jdbc:mysql://localhost:3306/userDb
            prop.userName=root
            prop.password=root
            ```
            
        - æŠŠå¤–éƒ¨ properties å±æ€§æ–‡ä»¶å¼•å…¥åˆ° spring é…ç½®æ–‡ä»¶ä¸­ â€”â€” å¼•å…¥ context åç§°ç©ºé—´
            
            ```xml
            <beans xmlns="http://www.springframework.org/schema/beans"
                   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xmlns:context="http://www.springframework.org/schema/context"
                   xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
                                       http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd"><!--å¼•å…¥contextåç§°ç©ºé—´-->
                
                    <!--å¼•å…¥å¤–éƒ¨å±æ€§æ–‡ä»¶-->
                <context:property-placeholder location="classpath:jdbc.properties"/>
            
                <!--é…ç½®è¿æ¥æ± -->
                <bean id="dataSource" class="com.alibaba.druid.pool.DruidDataSource">
                    <property name="driverClassName" value="${prop.driverClass}"></property>
                    <property name="url" value="${prop.url}"></property>
                    <property name="username" value="${prop.userName}"></property>
                    <property name="password" value="${prop.password}"></property>
                </bean>
                
            </beans>
            ```
            

### IOCæ“ä½œBeanç®¡ç†ï¼ˆåŸºäºæ³¨è§£æ–¹å¼ï¼‰

1. ä»€ä¹ˆæ˜¯æ³¨è§£
    1. æ³¨è§£æ˜¯ä»£ç ç‰¹æ®Šæ ‡è®°ã€‚æ ¼å¼ï¼š@æ³¨è§£åç§°(å±æ€§åç§°=å±æ€§å€¼, å±æ€§åç§°=å±æ€§å€¼..)
    2. ä½¿ç”¨æ³¨è§£ï¼šæ³¨è§£ä½œç”¨åœ¨ç±»ä¸Šé¢ï¼Œæ–¹æ³•ä¸Šé¢ï¼Œå±æ€§ä¸Šé¢
    3. ä½¿ç”¨æ³¨è§£ç›®çš„ï¼šç®€åŒ–xmlé…ç½®
2. Springé’ˆå¯¹Beanç®¡ç†ä¸­åˆ›å»ºå¯¹è±¡æä¾›æ³¨è§£
    1. @Component
    2. @Service
    3. @Controller
    4. @Repository
    
    <aside>
    ğŸ’¡ ä¸Šé¢å››ä¸ªæ³¨è§£åŠŸèƒ½æ˜¯ä¸€æ ·çš„ï¼Œéƒ½å¯ä»¥ç”¨æ¥åˆ›å»ºbeanå®ä¾‹
    
    </aside>
    
3. åŸºäºæ³¨è§£æ–¹å¼å®ç°å¯¹è±¡åˆ›å»º
    1. å¼•å…¥ä¾èµ–ã€
        
        spring-aop-5.2.6.RELEASE.jar
        
    2. å¼€å¯ç»„ä»¶æ‰«æ
        
        ```xml
        <!--å¼€å¯ç»„ä»¶æ‰«æ
         1 å¦‚æœæ‰«æå¤šä¸ªåŒ…ï¼Œå¤šä¸ªåŒ…ä½¿ç”¨é€—å·éš”å¼€
         2 æ‰«æåŒ…ä¸Šå±‚ç›®å½•
        -->
        <context:component-scan base-package="com.atguigu"></context:component-scan>
        ```
        
    3. åˆ›å»ºç±»ï¼Œåœ¨ç±»ä¸Šé¢æ·»åŠ åˆ›å»ºå¯¹è±¡æ³¨è§£
        
        ```java
        //åœ¨æ³¨è§£é‡Œé¢ value å±æ€§å€¼å¯ä»¥çœç•¥ä¸å†™ï¼Œ
        //é»˜è®¤å€¼æ˜¯ç±»åç§°ï¼Œé¦–å­—æ¯å°å†™
        //UserService -- userService
        @Component(value = "userService") //æ³¨è§£ç­‰åŒäºXMLé…ç½®æ–‡ä»¶ï¼š<bean id="userService" class=".."/>
        public class UserService {
         public void add() {
         System.out.println("service add.......");
         }
        }
        ```
        
4. å¼€å¯ç»„ä»¶æ‰«æç»†èŠ‚é…ç½®
    
    ```xml
    <!--ç¤ºä¾‹ 1
     use-default-filters="false" è¡¨ç¤ºç°åœ¨ä¸ä½¿ç”¨é»˜è®¤ filterï¼Œè‡ªå·±é…ç½® filter
     context:include-filter ï¼Œè®¾ç½®æ‰«æå“ªäº›å†…å®¹
    -->
    <context:component-scan base-package="com.atguigu" use-defaultfilters="false">
    	<context:include-filter type="annotation" expression="org.springframework.stereotype.Controller"/>
    	<!--ä»£è¡¨åªæ‰«æControlleræ³¨è§£çš„ç±»-->
    </context:component-scan>
    
    <!--ç¤ºä¾‹ 2
     ä¸‹é¢é…ç½®æ‰«æåŒ…æ‰€æœ‰å†…å®¹
     context:exclude-filterï¼š è®¾ç½®å“ªäº›å†…å®¹ä¸è¿›è¡Œæ‰«æ
    -->
    <context:component-scan base-package="com.atguigu">
    	<context:exclude-filter type="annotation" expression="org.springframework.stereotype.Controller"/>
    	<!--è¡¨ç¤ºControlleræ³¨è§£çš„ç±»ä¹‹å¤–ä¸€åˆ‡éƒ½è¿›è¡Œæ‰«æ-->
    </context:component-scan>
    ```
    
5. åŸºäºæ³¨è§£æ–¹å¼å®ç°å±æ€§æ³¨å…¥
    - @Autowiredï¼šæ ¹æ®å±æ€§ç±»å‹è¿›è¡Œè‡ªåŠ¨è£…é…
        - åˆ›å»ºuserServiceå’ŒuserDaoå¯¹è±¡ï¼šåœ¨UserServiceå’ŒUserDaoç±»æ·»åŠ åˆ›å»ºå¯¹è±¡æ³¨è§£
        - åœ¨userServiceæ³¨å…¥userDaoå¯¹è±¡ï¼šåœ¨UserServiceç±»æ·»åŠ UserDaoç±»å‹å±æ€§ï¼Œåœ¨å±æ€§ä¸Šé¢ä½¿ç”¨â€™@Autowiredâ€˜æ³¨è§£
        
        ```java
        @Service
        public class UserService {
         //å®šä¹‰ dao ç±»å‹å±æ€§
         //ä¸éœ€è¦æ·»åŠ  set æ–¹æ³•
         //æ·»åŠ æ³¨å…¥å±æ€§æ³¨è§£
         @Autowired
         private UserDao userDao;
         public void add() {
         System.out.println("service add.......");
         userDao.add();
         }
        }
        
        //Daoå®ç°ç±»
        @Repository
        //@Repository(value = "userDaoImpl1")
        public class UserDaoImpl implements UserDao {
            @Override
            public void add() {
                System.out.println("dao add.....");
            }
        }
        ```
        
    - @Qualifierï¼šæ ¹æ®åç§°è¿›è¡Œæ³¨å…¥
        - @Qualifieræ³¨è§£çš„ä½¿ç”¨ï¼Œå’Œä¸Šé¢@Autowiredä¸€èµ·ä½¿ç”¨
        
        ```java
        //å®šä¹‰ dao ç±»å‹å±æ€§
        //ä¸éœ€è¦æ·»åŠ  set æ–¹æ³•
        //æ·»åŠ æ³¨å…¥å±æ€§æ³¨è§£
        @Autowired //æ ¹æ®ç±»å‹è¿›è¡Œæ³¨å…¥
        //æ ¹æ®åç§°è¿›è¡Œæ³¨å…¥ï¼ˆç›®çš„åœ¨äºåŒºåˆ«åŒä¸€æ¥å£ä¸‹æœ‰å¤šä¸ªå®ç°ç±»ï¼Œæ ¹æ®ç±»å‹å°±æ— æ³•é€‰æ‹©ï¼Œä»è€Œå‡ºé”™ï¼ï¼‰
        @Qualifier(value = "userDaoImpl1") 
        private UserDao userDao;
        ```
        
    - @Resourceï¼šå¯ä»¥æ ¹æ®ç±»å‹æ³¨å…¥ï¼Œä¹Ÿå¯ä»¥æ ¹æ®åç§°æ³¨å…¥ï¼ˆå®ƒå±äºjavaxåŒ…ä¸‹çš„æ³¨è§£ï¼Œä¸æ¨èä½¿ç”¨ï¼ï¼‰
        
        ```java
        //@Resource //æ ¹æ®ç±»å‹è¿›è¡Œæ³¨å…¥
        @Resource(name = "userDaoImpl1") //æ ¹æ®åç§°è¿›è¡Œæ³¨å…¥
        private UserDao userDao;
        ```
        
    - @Valueï¼šæ³¨å…¥æ™®é€šç±»å‹å±æ€§
        
        ```java
        @Value(value = "abc")
        private String name
        ```
        
6. å®Œå…¨æ³¨è§£å¼€å‘
    1. åˆ›å»ºé…ç½®ç±»ï¼Œæ›¿ä»£ xml é…ç½®æ–‡ä»¶
        
        ```java
        @Configuration //ä½œä¸ºé…ç½®ç±»ï¼Œæ›¿ä»£ xml é…ç½®æ–‡ä»¶
        @ComponentScan(basePackages = {"com.atguigu"})
        public class SpringConfig {
            
        }
        ```
        
    2. ç¼–å†™æµ‹è¯•ç±»
        
        ```java
        @Test
        public void testService2() {
         //åŠ è½½é…ç½®ç±»
         ApplicationContext context
         = new AnnotationConfigApplicationContext(SpringConfig.class);
         UserService userService = context.getBean("userService",UserService.class);
         System.out.println(userService);
         userService.add();
        }
        ```